shadow$provide["module$node_modules$dom_align$lib$align$align"]=function(global,process,require,module,exports,shadow$shims){Object.defineProperty(exports,"__esModule",{value:true});var _utils=require("module$node_modules$dom_align$lib$utils");var _utils2=_interopRequireDefault(_utils);var _getVisibleRectForElement=require("module$node_modules$dom_align$lib$getVisibleRectForElement");var _getVisibleRectForElement2=_interopRequireDefault(_getVisibleRectForElement);var _adjustForViewport=require("module$node_modules$dom_align$lib$adjustForViewport");
var _adjustForViewport2=_interopRequireDefault(_adjustForViewport);var _getRegion=require("module$node_modules$dom_align$lib$getRegion");var _getRegion2=_interopRequireDefault(_getRegion);var _getElFuturePos=require("module$node_modules$dom_align$lib$getElFuturePos");var _getElFuturePos2=_interopRequireDefault(_getElFuturePos);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function isFailX(elFuturePos,elRegion,visibleRect){return elFuturePos.left<visibleRect.left||
elFuturePos.left+elRegion.width>visibleRect.right}function isFailY(elFuturePos,elRegion,visibleRect){return elFuturePos.top<visibleRect.top||elFuturePos.top+elRegion.height>visibleRect.bottom}function isCompleteFailX(elFuturePos,elRegion,visibleRect){return elFuturePos.left>visibleRect.right||elFuturePos.left+elRegion.width<visibleRect.left}function isCompleteFailY(elFuturePos,elRegion,visibleRect){return elFuturePos.top>visibleRect.bottom||elFuturePos.top+elRegion.height<visibleRect.top}function flip(points,
reg,map){var ret=[];_utils2["default"].each(points,function(p){ret.push(p.replace(reg,function(m){return map[m]}))});return ret}function flipOffset(offset,index){offset[index]=-offset[index];return offset}function convertOffset(str,offsetLen){var n=void 0;if(/%$/.test(str))n=parseInt(str.substring(0,str.length-1),10)/100*offsetLen;else n=parseInt(str,10);return n||0}function normalizeOffset(offset,el){offset[0]=convertOffset(offset[0],el.width);offset[1]=convertOffset(offset[1],el.height)}function doAlign(el,
tgtRegion,align,isTgtRegionVisible){var points=align.points;var offset=align.offset||[0,0];var targetOffset=align.targetOffset||[0,0];var overflow=align.overflow;var source=align.source||el;offset=[].concat(offset);targetOffset=[].concat(targetOffset);overflow=overflow||{};var newOverflowCfg={};var fail=0;var visibleRect=(0,_getVisibleRectForElement2["default"])(source);var elRegion=(0,_getRegion2["default"])(source);normalizeOffset(offset,elRegion);normalizeOffset(targetOffset,tgtRegion);var elFuturePos=
(0,_getElFuturePos2["default"])(elRegion,tgtRegion,points,offset,targetOffset);var newElRegion=_utils2["default"].merge(elRegion,elFuturePos);if(visibleRect&&(overflow.adjustX||overflow.adjustY)&&isTgtRegionVisible){if(overflow.adjustX)if(isFailX(elFuturePos,elRegion,visibleRect)){var newPoints=flip(points,/[lr]/ig,{l:"r",r:"l"});var newOffset=flipOffset(offset,0);var newTargetOffset=flipOffset(targetOffset,0);var newElFuturePos=(0,_getElFuturePos2["default"])(elRegion,tgtRegion,newPoints,newOffset,
newTargetOffset);if(!isCompleteFailX(newElFuturePos,elRegion,visibleRect)){fail=1;points=newPoints;offset=newOffset;targetOffset=newTargetOffset}}if(overflow.adjustY)if(isFailY(elFuturePos,elRegion,visibleRect)){var _newPoints=flip(points,/[tb]/ig,{t:"b",b:"t"});var _newOffset=flipOffset(offset,1);var _newTargetOffset=flipOffset(targetOffset,1);var _newElFuturePos=(0,_getElFuturePos2["default"])(elRegion,tgtRegion,_newPoints,_newOffset,_newTargetOffset);if(!isCompleteFailY(_newElFuturePos,elRegion,
visibleRect)){fail=1;points=_newPoints;offset=_newOffset;targetOffset=_newTargetOffset}}if(fail){elFuturePos=(0,_getElFuturePos2["default"])(elRegion,tgtRegion,points,offset,targetOffset);_utils2["default"].mix(newElRegion,elFuturePos)}var isStillFailX=isFailX(elFuturePos,elRegion,visibleRect);var isStillFailY=isFailY(elFuturePos,elRegion,visibleRect);if(isStillFailX||isStillFailY){points=align.points;offset=align.offset||[0,0];targetOffset=align.targetOffset||[0,0]}newOverflowCfg.adjustX=overflow.adjustX&&
isStillFailX;newOverflowCfg.adjustY=overflow.adjustY&&isStillFailY;if(newOverflowCfg.adjustX||newOverflowCfg.adjustY)newElRegion=(0,_adjustForViewport2["default"])(elFuturePos,elRegion,visibleRect,newOverflowCfg)}if(newElRegion.width!==elRegion.width)_utils2["default"].css(source,"width",_utils2["default"].width(source)+newElRegion.width-elRegion.width);if(newElRegion.height!==elRegion.height)_utils2["default"].css(source,"height",_utils2["default"].height(source)+newElRegion.height-elRegion.height);
_utils2["default"].offset(source,{left:newElRegion.left,top:newElRegion.top},{useCssRight:align.useCssRight,useCssBottom:align.useCssBottom,useCssTransform:align.useCssTransform,ignoreShake:align.ignoreShake});return{points:points,offset:offset,targetOffset:targetOffset,overflow:newOverflowCfg}}exports["default"]=doAlign;module.exports=exports["default"]}
//# sourceMappingURL=module$node_modules$dom_align$lib$align$align.js.map
